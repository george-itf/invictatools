{% comment %}
  ============================================================================
  DEPRECATED — Use invicta-category-grid.liquid or invicta-quick-cats.liquid.
  Not referenced by any template. Safe to remove.
  ============================================================================
  INVICTA POPULAR CATEGORIES
  ============================================================================
  Homepage section showing featured category cards.
  
  Each card is a block — select collection or set custom link.
  Clean, matte, trade-professional. No glow.
  
  Trade 15.4.0 Compatible
  ============================================================================
{% endcomment %}

<div 
  class="inv-pop-cats"
  data-section-id="{{ section.id }}"
  style="
    --inv-pop-columns: {{ section.settings.columns_desktop }};
    --inv-pop-columns-tablet: {{ section.settings.columns_tablet }};
    --inv-pop-columns-mobile: {{ section.settings.columns_mobile }};
    --inv-pop-gap: {{ section.settings.grid_gap }}px;
    --inv-pop-card-radius: {{ section.settings.card_radius }}px;
    --inv-pop-image-ratio: {{ section.settings.image_ratio }}%;
    --inv-pop-bg: {{ section.settings.section_bg }};
    --inv-pop-card-bg: {{ section.settings.card_bg }};
    --inv-pop-card-border: {{ section.settings.card_border }};
    --inv-pop-card-hover-border: {{ section.settings.card_hover_border }};
    --inv-pop-title-color: {{ section.settings.title_color }};
    --inv-pop-heading-color: {{ section.settings.heading_color }};
  "
>
  <div class="inv-pop-cats__container page-width">
    
    {%- comment -%} Header {%- endcomment -%}
    {%- if section.settings.heading != blank -%}
    <div class="inv-pop-cats__header">
      <h2 class="inv-pop-cats__heading">{{ section.settings.heading }}</h2>
      {%- if section.settings.subheading != blank -%}
      <p class="inv-pop-cats__subheading">{{ section.settings.subheading }}</p>
      {%- endif -%}
    </div>
    {%- endif -%}
    
    {%- comment -%} Grid {%- endcomment -%}
    {%- if section.blocks.size > 0 -%}
    <div class="inv-pop-cats__grid">
      {%- for block in section.blocks -%}
        {%- case block.type -%}
          {%- when 'category' -%}
            {%- liquid
              assign card_title = block.settings.title
              assign card_link = block.settings.link
              assign card_image = block.settings.image
              assign card_collection = block.settings.collection
              
              # If collection is selected, use its data as fallback
              if card_collection != blank
                if card_title == blank
                  assign card_title = card_collection.title
                endif
                if card_link == blank
                  assign card_link = card_collection.url
                endif
                if card_image == blank
                  assign card_image = card_collection.image
                endif
              endif
            -%}
            
            <a 
              href="{{ card_link | default: '#' }}" 
              class="inv-pop-card"
              {{ block.shopify_attributes }}
            >
              {%- comment -%} Image {%- endcomment -%}
              <div class="inv-pop-card__image">
                {%- if card_image != blank -%}
                  {{ card_image | image_url: width: 800 | image_tag:
                    loading: 'lazy',
                    class: 'inv-pop-card__img',
                    widths: '300, 400, 600, 800',
                    sizes: '(min-width: 1200px) 220px, (min-width: 990px) 20vw, (min-width: 750px) 33vw, 50vw'
                  }}
                {%- else -%}
                  <div class="inv-pop-card__placeholder">
                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                      <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                      <circle cx="8.5" cy="8.5" r="1.5"/>
                      <polyline points="21 15 16 10 5 21"/>
                    </svg>
                  </div>
                {%- endif -%}
              </div>
              
              {%- comment -%} Title {%- endcomment -%}
              <div class="inv-pop-card__body">
                <h3 class="inv-pop-card__title">
                  {{ card_title | default: 'Category' }}
                </h3>
              </div>
            </a>
        {%- endcase -%}
      {%- endfor -%}
    </div>
    {%- else -%}
    
    {%- comment -%} Empty state for editor {%- endcomment -%}
    <div class="inv-pop-cats__empty">
      <p>Add category blocks to create your grid.</p>
    </div>
    {%- endif -%}
    
    {%- comment -%} View All Link {%- endcomment -%}
    {%- if section.settings.show_view_all and section.settings.view_all_link != blank -%}
    <div class="inv-pop-cats__footer">
      <a href="{{ section.settings.view_all_link }}" class="inv-pop-cats__view-all">
        {{ section.settings.view_all_text }}
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="5" y1="12" x2="19" y2="12"/>
          <polyline points="12 5 19 12 12 19"/>
        </svg>
      </a>
    </div>
    {%- endif -%}
    
  </div>
</div>

<style>
  /* ============================================
     INVICTA POPULAR CATEGORIES - STYLES
     ============================================ */
  
  .inv-pop-cats {
    padding: {{ section.settings.padding_top }}px 0 {{ section.settings.padding_bottom }}px;
    background-color: var(--inv-pop-bg);
  }
  
  .inv-pop-cats__container {
    max-width: var(--page-width, 1200px);
    margin: 0 auto;
    padding: 0 1.5rem;
  }
  
  /* ============================================
     HEADER
     ============================================ */
  
  .inv-pop-cats__header {
    text-align: {{ section.settings.header_align }};
    margin-bottom: 32px;
  }
  
  .inv-pop-cats__heading {
    margin: 0 0 8px;
    font-size: {{ section.settings.heading_size }}px;
    font-weight: 700;
    color: var(--inv-pop-heading-color);
    text-transform: {{ section.settings.heading_transform }};
    letter-spacing: {% if section.settings.heading_transform == 'uppercase' %}0.03em{% else %}0{% endif %};
  }
  
  .inv-pop-cats__subheading {
    margin: 0;
    font-size: 15px;
    color: #666;
  }
  
  /* ============================================
     GRID
     ============================================ */
  
  .inv-pop-cats__grid {
    display: grid;
    grid-template-columns: repeat(var(--inv-pop-columns), 1fr);
    gap: var(--inv-pop-gap);
  }
  
  .inv-pop-cats__empty {
    text-align: center;
    padding: 60px 20px;
    color: #666;
    background-color: #f8f8f8;
    border-radius: 12px;
    border: 2px dashed #ddd;
  }
  
  /* ============================================
     CARD
     ============================================ */
  
  .inv-pop-card {
    display: block;
    background-color: var(--inv-pop-card-bg);
    border-radius: var(--inv-pop-card-radius);
    border: 1px solid var(--inv-pop-card-border);
    overflow: hidden;
    text-decoration: none;
    transition: border-color 0.15s ease;
  }
  
  .inv-pop-card:hover {
    border-color: var(--inv-pop-card-hover-border);
  }
  
  /* Image */
  .inv-pop-card__image {
    position: relative;
    width: 100%;
    padding-bottom: var(--inv-pop-image-ratio);
    background-color: {{ section.settings.image_bg }};
    overflow: hidden;
  }
  
  .inv-pop-card__img {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: contain;
    padding: 16px;
    transition: transform 0.3s ease;
  }
  
  .inv-pop-card:hover .inv-pop-card__img {
    transform: scale(1.05);
  }
  
  .inv-pop-card__placeholder {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #ccc;
  }
  
  /* Body */
  .inv-pop-card__body {
    padding: {{ section.settings.card_padding }}px;
    text-align: center;
  }
  
  .inv-pop-card__title {
    margin: 0;
    font-size: {{ section.settings.card_title_size }}px;
    font-weight: 600;
    color: var(--inv-pop-title-color);
    line-height: 1.3;
  }
  
  /* ============================================
     FOOTER / VIEW ALL
     ============================================ */
  
  .inv-pop-cats__footer {
    text-align: center;
    margin-top: 32px;
  }
  
  .inv-pop-cats__view-all {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 12px 24px;
    font-size: 14px;
    font-weight: 600;
    color: #fff;
    background-color: #2d2d2d;
    border-radius: 6px;
    text-decoration: none;
    transition: background-color 0.15s ease;
  }
  
  .inv-pop-cats__view-all:hover {
    background-color: #444;
  }
  
  /* ============================================
     RESPONSIVE - TABLET
     ============================================ */
  
  @media screen and (max-width: 989px) {
    .inv-pop-cats {
      padding: {{ section.settings.padding_top | times: 0.8 | round }}px 0 {{ section.settings.padding_bottom | times: 0.8 | round }}px;
    }
    
    .inv-pop-cats__container {
      padding: 0 1rem;
    }
    
    .inv-pop-cats__heading {
      font-size: {{ section.settings.heading_size | times: 0.85 | round }}px;
    }
    
    .inv-pop-cats__grid {
      grid-template-columns: repeat(var(--inv-pop-columns-tablet), 1fr);
      gap: calc(var(--inv-pop-gap) * 0.75);
    }
  }
  
  /* ============================================
     RESPONSIVE - MOBILE
     ============================================ */
  
  @media screen and (max-width: 749px) {
    .inv-pop-cats {
      padding: {{ section.settings.padding_top | times: 0.6 | round }}px 0 {{ section.settings.padding_bottom | times: 0.6 | round }}px;
    }
    
    .inv-pop-cats__header {
      margin-bottom: 24px;
    }
    
    .inv-pop-cats__heading {
      font-size: {{ section.settings.heading_size | times: 0.7 | round }}px;
    }
    
    .inv-pop-cats__grid {
      grid-template-columns: repeat(var(--inv-pop-columns-mobile), 1fr);
      gap: calc(var(--inv-pop-gap) * 0.5);
    }
    
    .inv-pop-card__body {
      padding: 12px;
    }
    
    .inv-pop-card__title {
      font-size: {{ section.settings.card_title_size | times: 0.85 | round }}px;
    }
    
    .inv-pop-cats__footer {
      margin-top: 24px;
    }
    
    .inv-pop-cats__view-all {
      padding: 10px 20px;
      font-size: 13px;
    }
  }
</style>

{% schema %}
{
  "name": "Popular Categories",
  "tag": "section",
  "class": "inv-popular-categories-section",
  "settings": [
    {
      "type": "header",
      "content": "Header"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "POPULAR CATEGORIES"
    },
    {
      "type": "text",
      "id": "subheading",
      "label": "Subheading"
    },
    {
      "type": "select",
      "id": "header_align",
      "label": "Header alignment",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Centre" }
      ],
      "default": "left"
    },
    {
      "type": "header",
      "content": "Grid Layout"
    },
    {
      "type": "range",
      "id": "columns_desktop",
      "label": "Columns (desktop)",
      "min": 3,
      "max": 6,
      "step": 1,
      "default": 5
    },
    {
      "type": "range",
      "id": "columns_tablet",
      "label": "Columns (tablet)",
      "min": 2,
      "max": 4,
      "step": 1,
      "default": 3
    },
    {
      "type": "range",
      "id": "columns_mobile",
      "label": "Columns (mobile)",
      "min": 1,
      "max": 3,
      "step": 1,
      "default": 2
    },
    {
      "type": "range",
      "id": "grid_gap",
      "label": "Gap between cards",
      "min": 12,
      "max": 32,
      "step": 4,
      "default": 16,
      "unit": "px"
    },
    {
      "type": "header",
      "content": "Card Settings"
    },
    {
      "type": "range",
      "id": "card_radius",
      "label": "Card border radius",
      "min": 0,
      "max": 16,
      "step": 2,
      "default": 8,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "card_padding",
      "label": "Card body padding",
      "min": 8,
      "max": 20,
      "step": 2,
      "default": 14,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "image_ratio",
      "label": "Image aspect ratio (%)",
      "min": 60,
      "max": 120,
      "step": 5,
      "default": 100,
      "unit": "%",
      "info": "100% = square"
    },
    {
      "type": "header",
      "content": "View All Link"
    },
    {
      "type": "checkbox",
      "id": "show_view_all",
      "label": "Show View All button",
      "default": false
    },
    {
      "type": "url",
      "id": "view_all_link",
      "label": "View All link"
    },
    {
      "type": "text",
      "id": "view_all_text",
      "label": "View All text",
      "default": "View All Categories"
    },
    {
      "type": "header",
      "content": "Section Spacing"
    },
    {
      "type": "range",
      "id": "padding_top",
      "label": "Padding top",
      "min": 20,
      "max": 80,
      "step": 4,
      "default": 48,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "label": "Padding bottom",
      "min": 20,
      "max": 80,
      "step": 4,
      "default": 48,
      "unit": "px"
    },
    {
      "type": "header",
      "content": "Typography"
    },
    {
      "type": "range",
      "id": "heading_size",
      "label": "Heading size",
      "min": 20,
      "max": 40,
      "step": 2,
      "default": 24,
      "unit": "px"
    },
    {
      "type": "select",
      "id": "heading_transform",
      "label": "Heading style",
      "options": [
        { "value": "none", "label": "Normal" },
        { "value": "uppercase", "label": "Uppercase" }
      ],
      "default": "uppercase"
    },
    {
      "type": "range",
      "id": "card_title_size",
      "label": "Card title size",
      "min": 12,
      "max": 18,
      "step": 1,
      "default": 14,
      "unit": "px"
    },
    {
      "type": "header",
      "content": "Colours - Section"
    },
    {
      "type": "color",
      "id": "section_bg",
      "label": "Section background",
      "default": "#f5f5f5"
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading colour",
      "default": "#1a1a1a"
    },
    {
      "type": "header",
      "content": "Colours - Cards"
    },
    {
      "type": "color",
      "id": "card_bg",
      "label": "Card background",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "card_border",
      "label": "Card border",
      "default": "#e5e5e5"
    },
    {
      "type": "color",
      "id": "card_hover_border",
      "label": "Card border (hover)",
      "default": "#2d2d2d"
    },
    {
      "type": "color",
      "id": "image_bg",
      "label": "Image background",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "title_color",
      "label": "Card title colour",
      "default": "#1a1a1a"
    }
  ],
  "blocks": [
    {
      "type": "category",
      "name": "Category",
      "settings": [
        {
          "type": "collection",
          "id": "collection",
          "label": "Collection",
          "info": "Select a collection to auto-fill title, link, and image."
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title override",
          "info": "Leave blank to use collection title."
        },
        {
          "type": "url",
          "id": "link",
          "label": "Link override",
          "info": "Leave blank to use collection URL."
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image override",
          "info": "Leave blank to use collection image."
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Popular Categories",
      "blocks": [
        {
          "type": "category",
          "settings": {
            "title": "Cordless Drills"
          }
        },
        {
          "type": "category",
          "settings": {
            "title": "SDS Drills"
          }
        },
        {
          "type": "category",
          "settings": {
            "title": "Grinders"
          }
        },
        {
          "type": "category",
          "settings": {
            "title": "Outdoor Tools"
          }
        },
        {
          "type": "category",
          "settings": {
            "title": "Batteries & Chargers"
          }
        }
      ]
    }
  ]
}
{% endschema %}