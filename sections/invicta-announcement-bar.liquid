{% comment %}
  DEPRECATED — Use announcement-bar.liquid (Shopify core) instead.
  Not referenced by any template. header-group.json uses core announcement-bar.
  -----------------------------
  Invicta Announcement Bar v6.0
  -----------------------------
  • Rotates between 3 messages every 4 seconds
  • Clean formatting
  • Icons supported
{% endcomment %}

{% style %}
.invicta-announcement {
  background: var(--color-foreground, #e11d26);
  color: #ffffff;
  font-size: 0.9rem;
  font-weight: 600;
  text-align: center;
  position: relative;
  overflow: hidden;
  height: 44px;
}

.invicta-announcement__track {
  position: relative;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
}

.invicta-announcement__slide {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  opacity: 0;
  visibility: hidden;
  transform: translateY(10px);
  transition: opacity 400ms ease-out, transform 400ms ease-out, visibility 400ms;
}

.invicta-announcement__slide.is-active {
  opacity: 1;
  visibility: visible;
  transform: translateY(0);
}

.invicta-announcement__slide.is-exiting {
  opacity: 0;
  visibility: hidden;
  transform: translateY(-10px);
}

.invicta-announcement__icon {
  width: 18px;
  height: 18px;
  flex-shrink: 0;
}

.invicta-announcement__text {
  display: flex;
  align-items: center;
  gap: 8px;
}

.invicta-announcement__link {
  color: inherit;
  text-decoration: underline;
  text-underline-offset: 3px;
  margin-left: 8px;
  font-weight: 700;
}

.invicta-announcement__link:hover {
  opacity: 0.85;
}

/* Pause on hover */
.invicta-announcement:hover .invicta-announcement__slide.is-active {
  /* Keep visible */
}
{% endstyle %}

<div class="invicta-announcement" data-announcement-bar>
  <div class="invicta-announcement__track">

    <!-- Slide 1: Free Delivery -->
    <div class="invicta-announcement__slide is-active" data-slide="0">
      <svg class="invicta-announcement__icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <rect x="1" y="3" width="15" height="13" rx="1"/>
        <path d="M16 8h4l3 3v5h-7V8z"/>
        <circle cx="5.5" cy="18.5" r="2.5"/>
        <circle cx="18.5" cy="18.5" r="2.5"/>
      </svg>
      <span class="invicta-announcement__text">
        {{ section.settings.message_1 | default: 'FREE Next Working Day Shipping on Orders Over £30!' }}
      </span>
    </div>

    <!-- Slide 2: Trade Counter -->
    <div class="invicta-announcement__slide" data-slide="1">
      <svg class="invicta-announcement__icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
        <circle cx="12" cy="10" r="3"/>
      </svg>
      <span class="invicta-announcement__text">
        {{ section.settings.message_2 | default: 'Visit Our Trade Counters: Canterbury & Ramsgate' }}
        {% if section.settings.message_2_link != blank %}
          <a href="{{ section.settings.message_2_link }}" class="invicta-announcement__link">Find Us →</a>
        {% endif %}
      </span>
    </div>

    <!-- Slide 3: Customer Service -->
    <div class="invicta-announcement__slide" data-slide="2">
      <svg class="invicta-announcement__icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>
      </svg>
      <span class="invicta-announcement__text">
        {{ section.settings.message_3 | default: 'Expert Advice: Call 01234 567890 — 25+ Years Trade Experience' }}
      </span>
    </div>

  </div>
</div>

<script>
(function() {
  /**
   * Announcement Bar Rotation
   * Rotates between slides every 4 seconds
   */
  const bar = document.querySelector('[data-announcement-bar]');
  if (!bar) return;

  const slides = bar.querySelectorAll('[data-slide]');
  if (slides.length < 2) return;

  let currentIndex = 0;
  let intervalId = null;
  const INTERVAL_MS = {{ section.settings.rotation_speed | default: 4000 }};

  function showSlide(index) {
    slides.forEach(function(slide, i) {
      if (i === index) {
        slide.classList.remove('is-exiting');
        slide.classList.add('is-active');
      } else if (slide.classList.contains('is-active')) {
        slide.classList.add('is-exiting');
        slide.classList.remove('is-active');
      } else {
        slide.classList.remove('is-active', 'is-exiting');
      }
    });
  }

  function nextSlide() {
    currentIndex = (currentIndex + 1) % slides.length;
    showSlide(currentIndex);
  }

  function startRotation() {
    if (intervalId) return;
    intervalId = setInterval(nextSlide, INTERVAL_MS);
  }

  function stopRotation() {
    if (intervalId) {
      clearInterval(intervalId);
      intervalId = null;
    }
  }

  // Pause on hover
  bar.addEventListener('mouseenter', stopRotation);
  bar.addEventListener('mouseleave', startRotation);

  // Start
  startRotation();
})();
</script>

{% schema %}
{
  "name": "Invicta Announcement Bar",
  "settings": [
    {
      "type": "text",
      "id": "message_1",
      "label": "Message 1",
      "default": "FREE Next Working Day Shipping on Orders Over £30!"
    },
    {
      "type": "text",
      "id": "message_2",
      "label": "Message 2",
      "default": "Visit Our Trade Counters: Canterbury & Ramsgate"
    },
    {
      "type": "url",
      "id": "message_2_link",
      "label": "Message 2 link"
    },
    {
      "type": "text",
      "id": "message_3",
      "label": "Message 3",
      "default": "Expert Advice: Call 01234 567890 — 25+ Years Trade Experience"
    },
    {
      "type": "range",
      "id": "rotation_speed",
      "label": "Rotation speed (ms)",
      "min": 2000,
      "max": 8000,
      "step": 500,
      "default": 4000
    }
  ],
  "presets": [
    {
      "name": "Invicta Announcement Bar"
    }
  ]
}
{% endschema %}