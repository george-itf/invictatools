{% comment %}
  ============================================
  INVICTA PROMO BANNERS v7.0
  ============================================
  Two image-backed banner cards matching the
  Invicta trade theme: sharp edges, bold type,
  dark overlays, no-nonsense industrial style.

  Supports:
  • Background images via image_picker
  • Date-windowed visibility per banner
  • Configurable overlay colour/opacity
  • Fully responsive (stacks on mobile)
  ============================================
{% endcomment %}

{%- liquid
  assign now_ts = 'now' | date: '%s' | plus: 0

  assign show_banner_1 = true
  if section.settings.banner_1_start != blank
    assign b1_start_ts = section.settings.banner_1_start | append: ' 00:00' | date: '%s' | plus: 0
    if b1_start_ts > 0 and now_ts < b1_start_ts
      assign show_banner_1 = false
    endif
  endif
  if section.settings.banner_1_end != blank
    assign b1_end_ts = section.settings.banner_1_end | append: ' 23:59' | date: '%s' | plus: 0
    if b1_end_ts > 0 and now_ts > b1_end_ts
      assign show_banner_1 = false
    endif
  endif

  assign show_banner_2 = true
  if section.settings.banner_2_start != blank
    assign b2_start_ts = section.settings.banner_2_start | append: ' 00:00' | date: '%s' | plus: 0
    if b2_start_ts > 0 and now_ts < b2_start_ts
      assign show_banner_2 = false
    endif
  endif
  if section.settings.banner_2_end != blank
    assign b2_end_ts = section.settings.banner_2_end | append: ' 23:59' | date: '%s' | plus: 0
    if b2_end_ts > 0 and now_ts > b2_end_ts
      assign show_banner_2 = false
    endif
  endif
-%}

{%- if show_banner_1 or show_banner_2 -%}
<section class="inv-promos" id="promos-{{ section.id }}">
  <div class="inv-container">
    <div class="inv-promos__grid{% unless show_banner_1 and show_banner_2 %} inv-promos__grid--single{% endunless %}">

      {%- if show_banner_1 -%}
      <a href="{{ section.settings.banner_1_link | default: '/collections/all' }}" class="inv-promos__card">
        {%- if section.settings.banner_1_image -%}
          <img
            src="{{ section.settings.banner_1_image | image_url: width: 800 }}"
            srcset="{{ section.settings.banner_1_image | image_url: width: 400 }} 400w,
                    {{ section.settings.banner_1_image | image_url: width: 600 }} 600w,
                    {{ section.settings.banner_1_image | image_url: width: 800 }} 800w"
            sizes="(max-width: 749px) 100vw, 50vw"
            alt="{{ section.settings.banner_1_title | escape }}"
            loading="lazy"
            width="{{ section.settings.banner_1_image.width }}"
            height="{{ section.settings.banner_1_image.height }}"
            class="inv-promos__bg"
          >
        {%- endif -%}
        <div class="inv-promos__overlay" style="background: {{ section.settings.banner_1_overlay }}; opacity: {{ section.settings.banner_1_overlay_opacity | divided_by: 100.0 }};"></div>
        <div class="inv-promos__content">
          {%- if section.settings.banner_1_tag != blank -%}
            <span class="inv-promos__tag">{{ section.settings.banner_1_tag }}</span>
          {%- endif -%}
          {%- if section.settings.banner_1_title != blank -%}
            <h2 class="inv-promos__title">{{ section.settings.banner_1_title }}</h2>
          {%- endif -%}
          {%- if section.settings.banner_1_subtitle != blank -%}
            <p class="inv-promos__subtitle">{{ section.settings.banner_1_subtitle }}</p>
          {%- endif -%}
        </div>
        <div class="inv-promos__arrow">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" aria-hidden="true">
            <polyline points="9 18 15 12 9 6"/>
          </svg>
        </div>
      </a>
      {%- endif -%}

      {%- if show_banner_2 -%}
      <a href="{{ section.settings.banner_2_link | default: '/collections/all' }}" class="inv-promos__card">
        {%- if section.settings.banner_2_image -%}
          <img
            src="{{ section.settings.banner_2_image | image_url: width: 800 }}"
            srcset="{{ section.settings.banner_2_image | image_url: width: 400 }} 400w,
                    {{ section.settings.banner_2_image | image_url: width: 600 }} 600w,
                    {{ section.settings.banner_2_image | image_url: width: 800 }} 800w"
            sizes="(max-width: 749px) 100vw, 50vw"
            alt="{{ section.settings.banner_2_title | escape }}"
            loading="lazy"
            width="{{ section.settings.banner_2_image.width }}"
            height="{{ section.settings.banner_2_image.height }}"
            class="inv-promos__bg"
          >
        {%- endif -%}
        <div class="inv-promos__overlay" style="background: {{ section.settings.banner_2_overlay }}; opacity: {{ section.settings.banner_2_overlay_opacity | divided_by: 100.0 }};"></div>
        <div class="inv-promos__content">
          {%- if section.settings.banner_2_tag != blank -%}
            <span class="inv-promos__tag">{{ section.settings.banner_2_tag }}</span>
          {%- endif -%}
          {%- if section.settings.banner_2_title != blank -%}
            <h2 class="inv-promos__title">{{ section.settings.banner_2_title }}</h2>
          {%- endif -%}
          {%- if section.settings.banner_2_subtitle != blank -%}
            <p class="inv-promos__subtitle">{{ section.settings.banner_2_subtitle }}</p>
          {%- endif -%}
        </div>
        <div class="inv-promos__arrow">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" aria-hidden="true">
            <polyline points="9 18 15 12 9 6"/>
          </svg>
        </div>
      </a>
      {%- endif -%}

    </div>
  </div>
</section>
{%- endif -%}

<style>
  /* ============================================
     INVICTA PROMO BANNERS v7.0
     Sharp, industrial, image-backed
     ============================================ */

  #promos-{{ section.id }} {
    padding: {{ section.settings.padding_top }}px 0 {{ section.settings.padding_bottom }}px;
    background: {{ section.settings.section_bg }};
  }

  .inv-promos__grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
  }

  .inv-promos__grid--single {
    grid-template-columns: 1fr;
  }

  /* --- Card --- */
  .inv-promos__card {
    position: relative;
    display: flex;
    align-items: flex-end;
    min-height: 220px;
    overflow: hidden;
    text-decoration: none;
    color: #fff;
    background: #2d2d2d;
    transition: transform 0.15s ease, box-shadow 0.15s ease;
  }

  .inv-promos__card:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
  }

  .inv-promos__card:focus-visible {
    outline: 2px solid #e11d26;
    outline-offset: 2px;
  }

  /* --- Background image --- */
  .inv-promos__bg {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    z-index: 0;
  }

  /* --- Dark overlay --- */
  .inv-promos__overlay {
    position: absolute;
    inset: 0;
    z-index: 1;
    pointer-events: none;
  }

  /* --- Content --- */
  .inv-promos__content {
    position: relative;
    z-index: 2;
    padding: 28px 32px;
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .inv-promos__tag {
    display: inline-block;
    background: #e11d26;
    color: #fff;
    padding: 5px 10px;
    font-size: 11px;
    font-weight: 800;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    width: fit-content;
  }

  .inv-promos__title {
    font-size: clamp(20px, 2.5vw, 28px);
    font-weight: 1000;
    color: #ffffff;
    line-height: 1.1;
    margin: 0;
    text-transform: uppercase;
    letter-spacing: -0.01em;
  }

  .inv-promos__subtitle {
    font-size: 14px;
    font-weight: 500;
    opacity: 0.85;
    margin: 0;
    line-height: 1.4;
    max-width: 320px;
  }

  /* --- Arrow indicator --- */
  .inv-promos__arrow {
    position: absolute;
    top: 20px;
    right: 20px;
    z-index: 2;
    opacity: 0.5;
    transition: transform 0.15s ease, opacity 0.15s ease;
    color: #fff;
  }

  .inv-promos__card:hover .inv-promos__arrow {
    transform: translateX(3px);
    opacity: 1;
  }

  /* --- Responsive --- */
  @media (max-width: 749px) {
    .inv-promos__grid {
      grid-template-columns: 1fr;
      gap: 12px;
    }

    .inv-promos__card {
      min-height: 180px;
    }

    .inv-promos__content {
      padding: 20px 24px;
    }
  }

  @media (prefers-reduced-motion: reduce) {
    .inv-promos__card,
    .inv-promos__arrow {
      transition: none;
    }

    .inv-promos__card:hover {
      transform: none;
    }
  }
</style>

{% schema %}
{
  "name": "Invicta Promo Banners",
  "settings": [
    {
      "type": "header",
      "content": "Section"
    },
    {
      "type": "color",
      "id": "section_bg",
      "label": "Section background",
      "default": "#f5f5f5"
    },
    {
      "type": "range",
      "id": "padding_top",
      "label": "Top padding",
      "min": 0,
      "max": 60,
      "step": 4,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "label": "Bottom padding",
      "min": 0,
      "max": 60,
      "step": 4,
      "unit": "px",
      "default": 0
    },
    {
      "type": "header",
      "content": "Banner 1"
    },
    {
      "type": "image_picker",
      "id": "banner_1_image",
      "label": "Background image",
      "info": "Recommended: 800x400px. Falls back to dark grey."
    },
    {
      "type": "text",
      "id": "banner_1_tag",
      "label": "Tag text",
      "default": "New Arrivals"
    },
    {
      "type": "text",
      "id": "banner_1_title",
      "label": "Title",
      "default": "Latest Power Tools"
    },
    {
      "type": "text",
      "id": "banner_1_subtitle",
      "label": "Subtitle"
    },
    {
      "type": "url",
      "id": "banner_1_link",
      "label": "Link"
    },
    {
      "type": "color",
      "id": "banner_1_overlay",
      "label": "Overlay colour",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "banner_1_overlay_opacity",
      "label": "Overlay opacity",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "%",
      "default": 45
    },
    {
      "type": "text",
      "id": "banner_1_start",
      "label": "Start date (YYYY-MM-DD)",
      "info": "Leave blank to always show."
    },
    {
      "type": "text",
      "id": "banner_1_end",
      "label": "End date (YYYY-MM-DD)",
      "info": "Leave blank for no end date."
    },
    {
      "type": "header",
      "content": "Banner 2"
    },
    {
      "type": "image_picker",
      "id": "banner_2_image",
      "label": "Background image",
      "info": "Recommended: 800x400px. Falls back to dark grey."
    },
    {
      "type": "text",
      "id": "banner_2_tag",
      "label": "Tag text",
      "default": "Deals"
    },
    {
      "type": "text",
      "id": "banner_2_title",
      "label": "Title",
      "default": "Deals & Savings"
    },
    {
      "type": "text",
      "id": "banner_2_subtitle",
      "label": "Subtitle"
    },
    {
      "type": "url",
      "id": "banner_2_link",
      "label": "Link"
    },
    {
      "type": "color",
      "id": "banner_2_overlay",
      "label": "Overlay colour",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "banner_2_overlay_opacity",
      "label": "Overlay opacity",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "%",
      "default": 45
    },
    {
      "type": "text",
      "id": "banner_2_start",
      "label": "Start date (YYYY-MM-DD)",
      "info": "Leave blank to always show."
    },
    {
      "type": "text",
      "id": "banner_2_end",
      "label": "End date (YYYY-MM-DD)",
      "info": "Leave blank for no end date."
    }
  ],
  "presets": [
    {
      "name": "Invicta Promo Banners"
    }
  ]
}
{% endschema %}
